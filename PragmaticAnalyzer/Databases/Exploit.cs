using PragmaticAnalyzer.Abstractions;
using PragmaticAnalyzer.Core;
using System.ComponentModel;
using System.Text.Json.Serialization;

namespace PragmaticAnalyzer.Databases
{
    public class Exploit : ViewModelBase, IHasId, IHasDescription
    {
        public Guid GuidId { get; set; } = Guid.NewGuid();

        [Description("Идентификатор")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Id { get => Get<string>(); set => Set(value); }

        [JsonIgnore(Condition = JsonIgnoreCondition.Always)]
        public string DisplayedId => "EDB-ID: " + Id;

        [Description("Название")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Name { get => Get<string>(); set => Set(value); }

        [Description("CVE")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Cve { get => Get<string>(); set => Set(value); }

        [Description("Описание")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Description { get => Get<string>(); set => Set(value); }

        [Description("Автор")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Author { get => Get<string>(); set => Set(value); }

        [Description("Тип")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Type { get => Get<string>(); set => Set(value); }

        [Description("Платформа")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string Platform { get => Get<string>(); set => Set(value); }

        [Description("Дата публикации")]
        [JsonIgnore(Condition = JsonIgnoreCondition.WhenWritingNull)]
        public string DatePublication { get => Get<string>(); set => Set(value); }
    } // представление экслойта
}