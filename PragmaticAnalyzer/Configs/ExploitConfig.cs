using PragmaticAnalyzer.Core;

namespace PragmaticAnalyzer.Configs
{
    /// <summary>
    ///  Объект, хранящий настройки для парсинга эксплойтов
    /// </summary>
    public class ExploitConfig : ViewModelBase
    {
        public string MainUrl { get => Get<string>(); set => Set(value); } // http-адресс для парсинга экслойтов
        public string ExploitUrlVulners { get => Get<string>(); set => Set(value); } // http-адресс для парсинга экслойтов с сайта vulners.com
        public string ExploitUrlVdb { get => Get<string>(); set => Set(value); } // http-адресс для парсинга экслойтов с сайта exploit-db.com
        public int StartPoint { get => Get<int>(); set => Set(value); } // идентификатор последней добавленной записи

        public ExploitConfig()
        {
            MainUrl = "https://vulners.com/search/types/exploitdb/page/12";
            ExploitUrlVulners = "https://vulners.com/exploitdb/EDB-ID:";
            ExploitUrlVdb = "https://www.exploit-db.com/";
            StartPoint = 1;
        }

        public void Update(ExploitConfig newExploitConfig)
        {
            if (newExploitConfig is null) return;

            MainUrl = newExploitConfig.MainUrl;
            ExploitUrlVulners = newExploitConfig.ExploitUrlVulners;
            ExploitUrlVdb = newExploitConfig.ExploitUrlVdb;
            StartPoint = newExploitConfig.StartPoint;
        }
    }
}