using PragmaticAnalyzer.Core;

namespace PragmaticAnalyzer.Configs
{
    //
    //Объект, хранящий настройки для парсинга эксплойтов, сохраняется в формате .json
    //
    public class ExploitConfig : ViewModelBase
    {
        public string MainUrl { get => Get<string>(); set => Set(value); }
        public string ExploitUrlVulners { get => Get<string>(); set => Set(value); }
        public string ExploitUrlVdb { get => Get<string>(); set => Set(value); }
        public int StartPoint { get => Get<int>(); set => Set(value); }

        public ExploitConfig()
        {
            MainUrl = "https://vulners.com/search/types/exploitdb/page/12";
            ExploitUrlVulners = "https://vulners.com/exploitdb/EDB-ID:";
            ExploitUrlVdb = "https://www.exploit-db.com/";
            StartPoint = 1;
        }

        public void Update(ExploitConfig newExploitConfig)
        {
            if (newExploitConfig is null) return;

            MainUrl = newExploitConfig.MainUrl;
            ExploitUrlVulners = newExploitConfig.ExploitUrlVulners;
            ExploitUrlVdb = newExploitConfig.ExploitUrlVdb;
            StartPoint = newExploitConfig.StartPoint;
        }
    }
}